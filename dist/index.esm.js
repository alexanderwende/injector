const e="ioc:parameters",t="ioc:properties";class n{constructor(e,t=!1){this.token=e,this.optional=t}}const r=e=>Reflect.getOwnMetadata("ioc:token",e),s=(e,t)=>{Reflect.defineMetadata("ioc:token",t,e)},o=(t,n)=>(p(t),Reflect.getOwnMetadata(e,t).get(n)),a=(t,n,r)=>{p(t);const s=Reflect.getOwnMetadata(e,t);Object.assign(s.get(n),r)},i=t=>(p(t),Reflect.getOwnMetadata(e,t)),c=(e,n)=>(d(e,n),Reflect.getOwnMetadata(t,e).get(n)),f=(e,n,r)=>{d(e,n);const s=Reflect.getOwnMetadata(t,e);Object.assign(s.get(n),r)},l=e=>(h(e),Reflect.getOwnMetadata(t,e)),p=t=>{if(!Reflect.hasOwnMetadata(e,t)){const r=Reflect.getOwnMetadata("design:paramtypes",t)||[],s=new Map(r.map((e,t)=>[t,new n(e)]));Reflect.defineMetadata(e,s,t)}},d=(e,t)=>{const r=l(e);if(!r.has(t)){const s=Reflect.getOwnMetadata("design:type",e.prototype,t);r.set(t,new n(s))}},h=e=>{Reflect.hasOwnMetadata(t,e)||Reflect.defineMetadata(t,new Map,e)};class g{constructor(e){this.description=e}}const u=e=>(t,n,r)=>{const s="number"==typeof r,i=e instanceof g?e:s?o(t,r).token:c(t.constructor,n).token;s?a(t,r,{token:i}):f(t.constructor,n,{token:i})},w=()=>e=>{const t=new g(e.name);s(e,t)},v=()=>(e,t,n)=>{"number"==typeof n?a(e,n,{optional:!0}):f(e.constructor,t,{optional:!0})},_=e=>(...t)=>Reflect.construct(e,t),O=e=>{let t;return(...n)=>(t||(t=Reflect.construct(e,n)),t)},b=e=>()=>e,M=new Error("Provider is not registered with an injector.");class R{constructor(e,t=new Map,n=new Map){this.factory=e,this.parameters=t instanceof Map?t:new Map(t.map((e,t)=>[t,e])),this.properties=n instanceof Map?n:new Map([...Object.getOwnPropertyNames(n).map(e=>[e,n[e]]),...Object.getOwnPropertySymbols(n).map(e=>[e,n[e]])])}provide(e){if(e||(e=this.injector),!e)throw M;const t=this.resolveParameters(e),n=this.resolveProperties(e);return this.createValue(t,n)}resolveParameters(e){const t=[];return this.parameters.forEach((r,s)=>{t[s]=r instanceof n?e.resolve(r.token,r.optional):r}),t}resolveProperties(e){const t={};return this.properties.forEach((r,s)=>{t[s]=r instanceof n?e.resolve(r.token,r.optional):r}),t}createValue(e=[],t={}){const n=this.factory(...e);return n instanceof Object?Object.assign(n,t):n}}class y extends R{constructor(e,t,n){super(_(e),t||i(e),n||l(e))}}class m extends y{provide(e){return this._instance||(this._instance=super.provide(e)),this._instance}}class j extends R{constructor(e){super(b(e))}}var P;const k=e=>new Error(`Class '${e.name}' has not been decorated as injectable and cannot be provided.`),E=e=>new Error(`Class '${e.name}' has not been decorated as injectable and cannot be resolved.`),x=e=>new Error(`No provider has been found for the requested token '${e.description}'.`);let C=P=class{constructor(...e){this._registry=new Map,this._parent=null,this._config={defaultProvider:y};const t=e.length&&e[0]instanceof P?e[0]:void 0,n=!e.length||e[0]instanceof P?e[1]?e[1]:void 0:e[0];t&&(this._parent=t,this._config=Object.assign({},t._config)),n&&(this._config=Object.assign({},this._config,n)),this.register(P,new j(this))}register(e,t){const n=e instanceof g?e:r(e);if(!n)throw k(e);t.injector=this,this._registry.set(n,t)}resolve(e,t=!1){let n;return n=e instanceof g?this._resolveToken(e,t):this._resolveConstructor(e,t)}_resolveConstructor(e,t=!1){const n=r(e);if(n)return this._getProvider(n)||this.register(n,new this._config.defaultProvider(e)),this._resolveToken(n,t);if(!t)throw E(e)}_resolveToken(e,t=!1){const n=this._getProvider(e);if(n)return n.provide(this);if(!t)throw x(e)}_getProvider(e){return this._registry.has(e)?this._registry.get(e):this._parent?this._parent._getProvider(e):void 0}};C=P=function(e,t,n,r){var s,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var i=e.length-1;i>=0;i--)(s=e[i])&&(a=(o<3?s(a):o>3?s(t,n,a):s(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a}([w(),function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}("design:paramtypes",[Object])],C);export{n as DependencyAnnotation,r as getTokenAnnotation,s as setTokenAnnotation,o as getParameterAnnotation,a as setParameterAnnotation,i as getParameterAnnotations,c as getPropertyAnnotation,f as setPropertyAnnotation,l as getPropertyAnnotations,u as inject,w as injectable,v as optional,_ as createClassFactory,O as createSingletonFactory,b as createValueFactory,M as PROVIDER_UNREGISTERED,R as BaseProvider,y as ClassProvider,m as SingletonProvider,j as ValueProvider,g as InjectToken,k as CLASS_NOT_PROVIDABLE,E as CLASS_NOT_RESOLVABLE,x as NO_PROVIDER,C as Injector};
//# sourceMappingURL=index.esm.js.map
